{"version":3,"file":"admin.js","mappings":"kCAEA,IAAIA,EAAa,4EAEjBC,EAAOC,QAAU,SAASC,GACtB,OAAQA,GAAQ,IAAIC,QAAQJ,GAAY,SAASK,GAC7C,MAAO,YAAcA,EAAM,KAAOA,EAAM,MAC5C,GACJ,C,GCPIC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaP,QAGrB,IAAID,EAASK,EAAyBE,GAAY,CAGjDN,QAAS,CAAC,GAOX,OAHAS,EAAoBH,GAAUP,EAAQA,EAAOC,QAASK,GAG/CN,EAAOC,OACf,CCrBAK,EAAoBK,EAAKX,IACxB,IAAIY,EAASZ,GAAUA,EAAOa,WAC7B,IAAOb,EAAiB,QACxB,IAAM,EAEP,OADAM,EAAoBQ,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdN,EAAoBQ,EAAI,CAACb,EAASe,KACjC,IAAI,IAAIC,KAAOD,EACXV,EAAoBY,EAAEF,EAAYC,KAASX,EAAoBY,EAAEjB,EAASgB,IAC5EE,OAAOC,eAAenB,EAASgB,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDX,EAAoBY,EAAI,CAACK,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFlB,EAAoBsB,EAAK3B,IACH,oBAAX4B,QAA0BA,OAAOC,aAC1CX,OAAOC,eAAenB,EAAS4B,OAAOC,YAAa,CAAEC,MAAO,WAE7DZ,OAAOC,eAAenB,EAAS,aAAc,CAAE8B,OAAO,GAAO,E,0ECL9D,MAAM,EAA+BC,OAAOC,KAAKC,OAAO,a,aCAzC,SAASC,EAAgBjB,EAAGkB,GAKzC,OAJAD,EAAkBhB,OAAOkB,eAAiBlB,OAAOkB,eAAeC,OAAS,SAAyBpB,EAAGkB,GAEnG,OADAlB,EAAEqB,UAAYH,EACPlB,CACT,EACOiB,EAAgBjB,EAAGkB,EAC5B,CCNA,MAAM,EAA+BJ,OAAOC,KAAKC,OAAO,2B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,kC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,yB,+BCUnCM,EAAiB,SAAAC,GCTvB,IAAwBC,EAAUC,EDSX,SAAAH,IAAA,OAAAC,EAAAG,MAAA,KAAAC,YAAA,KCTWF,EDSXF,GCTCC,EDSDF,GCR3Bf,UAAYN,OAAO2B,OAAOH,EAAWlB,WAC9CiB,EAASjB,UAAUsB,YAAcL,EACjCL,EAAeK,EAAUC,GDMW,IAAAK,EAAAR,EAAAf,UA6GnC,OA7GmCuB,EACpCC,QAAA,WACE,IAAMC,EAAUC,KAAKC,QAAQ,oBAAbD,GACVE,EAAyF,IAA7EC,OAAOC,IAAAA,KAASC,SAAS,sBAAsBN,EAAO,qBAClEO,EAAQF,IAAAA,KAASC,SAAS,sBAAsBN,EAAO,UAE7D,OACEQ,EAAA,OAAKC,UAAU,qBACbD,EAAA,OAAKC,UAAU,aACbD,EAAA,OAAKC,UAAU,oDACbD,EAAA,OAAKC,UAAU,QACZF,GACCC,EAACE,IAAK,CAACD,UAAU,aAAaE,aAAa,GACzCH,EAAA,KAAGI,MAAO,CAAEC,cAAe,YAAaC,YAAa,QAAUC,IAAU,IAAIC,KAAKb,KACjFI,GAGJN,KAAKgB,gBAAgBC,UACtBV,EAAA,OAAKC,UAAU,cAAcR,KAAKkB,mBAM9C,EAACrB,EAEDmB,cAAA,WACE,IAAMG,EAAQ,IAAIC,KAoBlB,OAlBAD,EAAME,IACJ,UACAd,EAAA,OAAKC,UAAU,WACbD,EAAA,UAAKH,IAAAA,WAAekB,MAAM,6CAC1Bf,EAAA,KAAGC,UAAU,YAAYJ,IAAAA,WAAekB,MAAM,0CAC7CtB,KAAKuB,eAAeN,YAIzBE,EAAME,IACJ,YACAd,EAAA,OAAKC,UAAU,WACbD,EAAA,UAAKH,IAAAA,WAAekB,MAAM,+CAC1Bf,EAAA,KAAGC,UAAU,YAAYJ,IAAAA,WAAekB,MAAM,4CAC7CtB,KAAKwB,gBAAgBP,YAInBE,CACT,EAACtB,EAED0B,aAAA,WACE,IAAMJ,EAAQ,IAAIC,KAYlB,OAVAD,EAAME,IACJ,aACArB,KAAKyB,sBAAsB,CACzBxB,QAAS,qBACTyB,KAAM,UACNC,MAAOvB,IAAAA,WAAekB,MAAM,4CAC5BM,KAAMxB,IAAAA,WAAekB,MAAM,8CAIxBH,CACT,EAACtB,EAED2B,cAAA,WACE,IAAML,EAAQ,IAAIC,KACZrB,EAAUC,KAAKC,QAAQ,oBAAbD,GAwChB,OAtCAmB,EAAME,IACJ,UACArB,KAAKyB,sBAAsB,CACzBC,KAAM,SACNzB,QAAS,oBACT0B,MAAOvB,IAAAA,WAAekB,MAAM,0CAC5BO,QAAUzB,IAAAA,KAAS,sBAAmC0B,QAAO,SAAC/D,EAA4BkB,GAExF,OADAlB,EAAEkB,GAAK8C,IAAY3B,IAAAA,WAAekB,MAAM,oCAAoCrC,EAAC,WACtElB,CACT,GAAG,CAAC,GACJiE,UAAU,EACVJ,KAAM7B,GAAWQ,EAAE0B,MAAMC,IAAQH,IAAY3B,IAAAA,WAAekB,MAAM,oCAAoCvB,EAAO,sBAIjH,CAAC,SAAU,YAAa,aAAaoC,SAASpC,IAC5CoB,EAAME,IACJ,UACArB,KAAKyB,sBAAsB,CACzBC,KAAM,SACNzB,QAAS,sBAAsBF,EAAO,cACtC4B,MAAOvB,IAAAA,WAAekB,MAAM,6CAC5BU,UAAU,KAIJ,WAAZjC,GACEoB,EAAME,IACJ,eACArB,KAAKyB,sBAAsB,CACzBC,KAAM,SACNzB,QAAS,kCACT0B,MAAOvB,IAAAA,WAAekB,MAAM,wCAC5Bc,IAAK,KACLC,YAAa,QAIZlB,CACT,EAAC9B,CAAA,CA7GmC,CAASiD,KERlCC,EAAa,CACxBlD,kBAAAA,GCDF,MCEA,EAAe,GAAfmD,ODFA,IEIApC,IAAAA,aAAiBiB,IAAI,aAAa,WAChCjB,IAAAA,cAAiB,IACV,aACJqC,aAAapD,GACbqD,mBACC,CACEC,KAAM,eACNC,WAAY,0BACZjB,MAAOvB,IAAAA,WAAekB,MAAM,4CAE9B,WACA,GAEN,G","sources":["webpack://@fof/geoip/./node_modules/linkify-lite/index.js","webpack://@fof/geoip/webpack/bootstrap","webpack://@fof/geoip/webpack/runtime/compat get default export","webpack://@fof/geoip/webpack/runtime/define property getters","webpack://@fof/geoip/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/geoip/webpack/runtime/make namespace object","webpack://@fof/geoip/external root \"flarum.core.compat['admin/app']\"","webpack://@fof/geoip/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/geoip/external root \"flarum.core.compat['common/components/Alert']\"","webpack://@fof/geoip/external root \"flarum.core.compat['admin/components/ExtensionPage']\"","webpack://@fof/geoip/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@fof/geoip/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/geoip/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/geoip/./src/admin/components/GeoipSettingsPage.tsx","webpack://@fof/geoip/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/geoip/./src/admin/components/index.ts","webpack://@fof/geoip/./src/common/extend.ts","webpack://@fof/geoip/./src/admin/extend.ts","webpack://@fof/geoip/./src/admin/index.ts"],"sourcesContent":["'use strict';\n\nvar urlPattern = /(?:https?:)?\\/\\/(?:(?:[\\w-]+\\.)+[\\w/#@~.-]*)(?:\\?(?:[\\w&=.!,;$#%-]+)?)?/gi;\n\nmodule.exports = function(text) {\n    return (text || '').replace(urlPattern, function(url) {\n        return '<a href=\"' + url + '\">' + url + '</a>';\n    });\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/app'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Alert'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/components/ExtensionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/humanTime'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","import app from 'flarum/admin/app';\nimport Alert from 'flarum/common/components/Alert';\nimport ExtensionPage from 'flarum/admin/components/ExtensionPage';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport extractText from 'flarum/common/utils/extractText';\nimport Mithril from 'mithril';\nimport ItemList from 'flarum/common/utils/ItemList';\n// @ts-expect-error\nimport linkify from 'linkify-lite';\n\nexport default class GeoipSettingsPage extends ExtensionPage {\n  content() {\n    const service = this.setting('fof-geoip.service')();\n    const errorTime = Number(app.data.settings[`fof-geoip.services.${service}.last_error_time`]) * 1000;\n    const error = app.data.settings[`fof-geoip.services.${service}.error`] as string | undefined;\n\n    return (\n      <div className=\"GeoipSettingsPage\">\n        <div className=\"container\">\n          <div className=\"GeoipSettingsTabPage GeoipSettingsPage--settings\">\n            <div className=\"Form\">\n              {error && (\n                <Alert className=\"Form-group\" dismissable={false}>\n                  <b style={{ textTransform: 'uppercase', marginRight: '5px' }}>{humanTime(new Date(errorTime))}</b>\n                  {error}\n                </Alert>\n              )}\n              {this.settingsItems().toArray()}\n              <div className=\"Form-group\">{this.submitButton()}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  settingsItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'general',\n      <div className=\"Section\">\n        <h3>{app.translator.trans('fof-geoip.admin.settings.general.heading')}</h3>\n        <p className=\"helpText\">{app.translator.trans('fof-geoip.admin.settings.general.help')}</p>\n        {this.generalItems().toArray()}\n      </div>\n    );\n\n    items.add(\n      'providers',\n      <div className=\"Section\">\n        <h3>{app.translator.trans('fof-geoip.admin.settings.providers.heading')}</h3>\n        <p className=\"helpText\">{app.translator.trans('fof-geoip.admin.settings.providers.help')}</p>\n        {this.providerItems().toArray()}\n      </div>\n    );\n\n    return items;\n  }\n\n  generalItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n\n    items.add(\n      'show-flags',\n      this.buildSettingComponent({\n        setting: 'fof-geoip.showFlag',\n        type: 'boolean',\n        label: app.translator.trans('fof-geoip.admin.settings.show_flag_label'),\n        help: app.translator.trans('fof-geoip.admin.settings.show_flag_help'),\n      })\n    );\n\n    return items;\n  }\n\n  providerItems(): ItemList<Mithril.Children> {\n    const items = new ItemList<Mithril.Children>();\n    const service = this.setting('fof-geoip.service')();\n\n    items.add(\n      'service',\n      this.buildSettingComponent({\n        type: 'select',\n        setting: 'fof-geoip.service',\n        label: app.translator.trans('fof-geoip.admin.settings.service_label'),\n        options: (app.data['fof-geoip.services'] as string[]).reduce((o: { [x: string]: string }, p: string) => {\n          o[p] = extractText(app.translator.trans(`fof-geoip.admin.settings.service_${p}_label`));\n          return o;\n        }, {}),\n        required: true,\n        help: service && m.trust(linkify(extractText(app.translator.trans(`fof-geoip.admin.settings.service_${service}_description`)))),\n      })\n    );\n\n    ['ipdata', 'ipapi-pro', 'ipsevenex'].includes(service) &&\n      items.add(\n        'api-key',\n        this.buildSettingComponent({\n          type: 'string',\n          setting: `fof-geoip.services.${service}.access_key`,\n          label: app.translator.trans('fof-geoip.admin.settings.access_key_label'),\n          required: true,\n        })\n      );\n\n    service === 'ipdata' &&\n      items.add(\n        'ipdata-quota',\n        this.buildSettingComponent({\n          type: 'number',\n          setting: 'fof-geoip.services.ipdata.quota',\n          label: app.translator.trans('fof-geoip.admin.settings.quota_label'),\n          min: 1500,\n          placeholder: 1500,\n        })\n      );\n\n    return items;\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import GeoipSettingsPage from './GeoipSettingsPage';\n\nexport const components = {\n  GeoipSettingsPage,\n};\n","import Extend from 'flarum/common/extenders';\n\nexport default [];\n","import Extend from 'flarum/common/extenders';\n\nimport { default as commonExtend } from '../common/extend';\n\nexport default [...commonExtend];\n","import app from 'flarum/admin/app';\nimport GeoipSettingsPage from './components/GeoipSettingsPage';\n\nexport * from './components';\nexport { default as extend } from './extend';\n\napp.initializers.add('fof/geoip', () => {\n  app.extensionData\n    .for('fof-geoip')\n    .registerPage(GeoipSettingsPage)\n    .registerPermission(\n      {\n        icon: 'fas fa-globe',\n        permission: 'fof-geoip.canSeeCountry',\n        label: app.translator.trans('fof-geoip.admin.permissions.see_country'),\n      },\n      'moderate',\n      50\n    );\n});\n"],"names":["urlPattern","module","exports","text","replace","url","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","GeoipSettingsPage","_ExtensionPage","subClass","superClass","apply","arguments","create","constructor","_proto","content","service","this","setting","errorTime","Number","app","settings","error","m","className","Alert","dismissable","style","textTransform","marginRight","humanTime","Date","settingsItems","toArray","submitButton","items","ItemList","add","trans","generalItems","providerItems","buildSettingComponent","type","label","help","options","reduce","extractText","required","trust","linkify","includes","min","placeholder","ExtensionPage","components","concat","registerPage","registerPermission","icon","permission"],"sourceRoot":""}